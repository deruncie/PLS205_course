library(limma)
?cpm
??cpm
library(edgeR)
?voom
a=fread('~/Downloads/lib_sizes.txt')
library(data.table)
a=fread('~/Downloads/lib_sizes.txt')
a=fread('~/Downloads/lib_sizes.txt',data.table = F)
head(a)
tail(a)
plot(a$V5)
plot(a$V5,log='y')
a$lane[grepl('L001',a$V9)] = 1
a$lane[grepl('L002',a$V9)] = 2
a$lane[grepl('L003',a$V9)] = 3
table(a$lane,useNA = 'a')
library(ggplot2)
ggplot(a,aes(x=log)) + geom_density(aes(color = lane))
ggplot(a,aes(x=log(V5))) + geom_density(aes(color = lane))
ggplot(a,aes(x=log(V5))) + geom_density(aes(color = lane,group=lane))
ggplot(subset(a,V5>1e6),aes(x=log(V5))) + geom_density(aes(color = lane,group=lane))
ggplot(subset(a,V5>1e6),aes(x=log(V5))) + geom_density(aes(color = factor(lane),group=lane))
a=fread('~/Downloads/lib_sizes.txt',data.table = F)
library(data.table)
a=fread('~/Downloads/lib_sizes.txt',data.table = F)
a$lane[grepl('L001',a$V9)] = 1
a$lane[grepl('L002',a$V9)] = 2
a$lane[grepl('L003',a$V9)] = 3
library(ggplot2)
ggplot(a,aes(x=log(V5))) + geom_density(aes(color = lane,group=lane))
ggplot(subset(a,V5>1e6),aes(x=log(V5))) + geom_density(aes(color = factor(lane),group=lane))
ggplot(subset(a,V5>1e6),aes(x=(V5))) + geom_density(aes(color = factor(lane),group=lane))
ggplot(subset(a,V5>1e6),aes(x=V5)) + geom_density(aes(color = factor(lane),group=lane))
head(a)
a$V5
ggplot(subset(a,V5>1e6),aes(x=V5)) + geom_density(aes(color = factor(lane),group=lane))
ggplot(subset(a,V5>1e6),aes(x=log(V5))) + geom_density(aes(color = factor(lane),group=lane))
summary(a$V5)
ggplot(subset(a,V5>1e6),aes(x=log(V5))) + geom_point(aes(color = factor(lane),group=lane))
ggplot(subset(a,V5>1e6),aes(y=log(V5))) + geom_point(aes(color = factor(lane),group=lane))
ggplot(subset(a,V5>1e6),aes(x=V5)) + geom_density(aes(color = factor(lane),group=lane))
ggplot(subset(a,V5>1e6),aes(x=V5+0.)) + geom_density(aes(color = factor(lane),group=lane))
ggplot(subset(a,V5>1e6),aes(x=V5+0.01)) + geom_density(aes(color = factor(lane),group=lane))
a$V5 = a$V5+0.0
ggplot(subset(a,V5>1e6),aes(x=V5)) + geom_density(aes(color = factor(lane),group=lane))
a$V5 = a$V5+0.01
ggplot(subset(a,V5>1e6),aes(x=V5)) + geom_density(aes(color = factor(lane),group=lane))
ggplot(a,aes(x=V5)) + geom_density(aes(color = factor(lane),group=lane))
ggplot(subset(a,V5>1e6),aes(x=sqrt(V5))) + geom_density(aes(color = factor(lane),group=lane))
ggplot(subset(a,V5),aes(x=sqrt(V5))) + geom_density(aes(color = factor(lane),group=lane))
a$V5
ggplot(subset(a,V5),aes(x=(V5))) + geom_density(aes(color = factor(lane),group=lane))
ggplot(subset(a),aes(x=(V5))) + geom_density(aes(color = factor(lane),group=lane))
ggplot(subset(a),aes(x=(V5))) + geom_density()
ggplot(subset(a),aes(x=as.numeric(V5))) + geom_density()
ggplot(subset(a),aes(x=as.numeric(V5))) + geom_density(aes(color = factor(lane),group=lane))
ggplot(subset(a),aes(x=log10(V5))) + geom_density(aes(color = factor(lane),group=lane))
ggplot(subset(a,V5>1e6),aes(x=log10(V5))) + geom_density(aes(color = factor(lane),group=lane))
ggplot(subset(a,V5>1e6),aes(x=(V5))) + geom_density(aes(color = factor(lane),group=lane))
ggplot(subset(a,V5>1e6),aes(x=as.numeric(V5))) + geom_density(aes(color = factor(lane),group=lane))
a$V5/median(a$V5)
plot(a$V5/median(a$V5))
abline(h=1)
plot(log2(a$V5/median(a$V5)))
3
pulse_data <- read.csv('Pulse experiment response.csv')
str(pulse_data)
colnames(pulse_data)[3] = 'Pulse'
head(pulse_data)
print('Sitting')
subset(pulse_data,Treatment == 'Sitting')$Pulse
print('Standing')
subset(pulse_data,Treatment == 'Standing')$Pulse
print('Sitting')
subset(pulse_data,Treatment == 'Sitting')$Pulse
print('Standing')
subset(pulse_data,Treatment == 'Standing')$Pulse
print('Sitting')
subset(pulse_data,Treatment == 'Sitting')$Pulse
print('Standing')
subset(pulse_data,Treatment == 'Standing')$Pulse
library(ggplot2)
set.seed(1)
ggplot(pulse_data,aes(x=Treatment,y=Pulse)) + geom_jitter(size=2,width = .1,alpha = 0.5)
library(ggplot2)
breaks = seq(30,130,by=5)
ggplot(pulse_data,aes(x=Pulse)) +
geom_histogram(binwidth = 5, center = 2.5,color = 'black',fill = 'grey70') +
facet_grid(Treatment~.)
# same, but re-scaled to percentages
ggplot(pulse_data,aes(x=Pulse)) +
geom_histogram(aes(y=..density..),binwidth = 5, center = 2.5,color = 'black',fill = 'grey70') +
facet_grid(Treatment~.) +
ggtitle('Probability plot')
# compare to jitter_plot
ggplot(pulse_data,aes(x=Treatment,y=Pulse)) + geom_jitter(size=2,width = .1,alpha = 0.5)  +
stat_summary(fun.y='mean', colour="darkred", geom="errorbar", aes(ymax = ..y.., ymin = ..y..))
# boxplot
ggplot(pulse_data,aes(x=Treatment,y=Pulse)) + geom_boxplot()
standing_obs = subset(pulse_data,Treatment == 'Standing')$Pulse
sitting_obs = subset(pulse_data,Treatment == 'Sitting')$Pulse
t_test = t.test(standing_obs, sitting_obs, paired = F, var.equal = T)
t_test
pulse_data <- read.csv('Pulse experiment response.csv')
str(pulse_data)
colnames(pulse_data)[3] = 'Pulse'
head(pulse_data)
pulse_data <- read.csv('Pulse experiment response.csv')
str(pulse_data)
head(pulse_data)
setwd("~/Box Sync/Classes/PLS205/Course materials/2020/HW/HW1")
