---
title: "HW 1"
author: "YOUR NAME"
output: 
 html_notebook:
    toc: true
    toc_float: true
    number_sections: true
---

> Grading Notes:
>
> For questions with a numeric result:
> Full credit: correct value
>  - wrong value due to data entry error / type: lose one point
>  - wrong value due to wrong approach: zero points
>  - wrong value due to previous error (ie a previous calculation was wrong): 
> full credit, but first fix the value above and re-run your code to check that you get the
> right value now.
>
> For questions that require a text answer:
> Full credit: requires an answer to each question asked. Your explanations need to valid
and logical. You don't need to use the same words as the key, but the meaning needs to be complete.
> Assign partial credit for answers that are incomplete. For multi-part questions, divide points
approximatly equally unless otherwise specified.
>
> For all questions, if you get the right answer using a different approach than I use, that is fine.

> Fill out the table below for each question (you can copy to another text file and fill it out there)
Then copy the table and paste it into the comments section for the submitted assignment on Canvas.

Grading table

| Question | Max  | Score |
|----------|------|-------|
| 1.1      | 4    |       |
| 1.2      | 4    |       |
| 1.3      | 4    |       |
| 1.4      | 4    |       |
| 1.5      | 4    |       |
| 2.1      | 5    |       |
| 3        | 15   |       |
| Total    | 40   |       |

---

# Part 1

## 10 numbers were generated by the computer from a normal population with mean=18 and standard deviation=5. 
[4 points]

| 15 | 18 | 24 | 28 | 14 | 19 | 25 | 17 | 20 | 18 |
|----|----|----|----|----|----|----|----|----|----|

Using `R` as a calculator (i.e., use only the commands you'd find on a hand calculator: `+ - * / sqrt`), calculate:

- mean
```{r}
# use this code block to enter your answer. Be sure to run the code block so that your answer prints out below
(15+18+24+28+14+19+25+17+20+18) / 10
```

- standard deviation
```{r}
sqrt(((15-19.8)^2 + (18-19.8)^2 + (24-19.8)^2 + (28-19.8)^2 + (14-19.8)^2 + (19-19.8)^2 + (25-19.8)^2 + (17-19.8)^2 + (20-19.8)^2 + (18-19.8)^2)/9)
```

- coefficient of variation (CV)
```{r}
4.516636/19.8
```

- standard error of the mean (SEM)
```{r}
4.516636/sqrt(10)
```

> [1 point per statistic]
> Note: if a previous statistic is wrong (mean or SD), but the calculation of CV or SE is right,
don't take off again for a wrong anser for CV. Correct your mean / SD calculation and re-run to check
that you now get the right CV


## Add 20 to each value and indicate the effect on the mean, standard deviation, coefficient of variation, and SE. Comment on the differences from above. You may now use the `mean` and `sd` functions.
[4 points]
```{r}
# mean
(35+38+44+48+34+39+45+37+40+38) / 10

# SD
sqrt(((35-39.8)^2 + (38-39.8)^2 + (44-39.8)^2 + (48-39.8)^2 + (34-39.8)^2 + (39-39.8)^2 + (45-39.8)^2 + (37-39.8)^2 + (40-39.8)^2 + (38-39.8)^2)/9)

# CV
4.516636/39.8

# SEM
4.516636/sqrt(10)
```

> The mean is increased by 20. The SD and SE are unchanged. The CV is decreased because the mean increased (denominator) but the SD didn't (numerator). Proportionally to the mean, the new data have less variation.


> [2 points for 4 statistics]
> [2 points for response]. Did you explain how each of the 4 statistics changed?


## Now, we have generated three additional samples of 10 numbers from the same distribution (mean = 18, sd=5). 
[4 points]
The data are in the R object called `data_1`. Calculate the mean, SD, CV and SE for each of the four samples. 

```{r echo=FALSE}
# DO NOT enter your own code here - it won't be printed in the output.

# This code enters the data into a data.frame called `data_2.3`. 
data_1 <- data.frame(
              Sample_1 = c( 15 , 18 , 24 , 28 , 14 , 19 , 25 , 17 , 20 , 18 ),
              Sample_2 = c( 28 ,  7 , 13 , 18 , 16 ,  8 , 16 , 17 , 16 , 18 ),
              Sample_3 = c( 16 ,  6 , 21 , 19 , 16 , 21 , 18 , 16 , 19 , 13 ),
              Sample_4 = c( 20 , 27 , 12 , 28 , 26 , 18 , 12 , 21 , 18 ,  9 )
            )

# You can print a data.frame to the screen / Notebook by typing it's name, and then CTRL+ENTER
data_1

# A data.frame is like a spreadsheet. You can access each column by referring to its name:
data_1$Sample_1

# or by it's index:
data_1[,1]
```

For this question, you can use R functions like `mean` or `sd`. 
Note: There are no built-in functions for CV or SE
```{r}
# mean
mean(data_1$Sample_1)
mean(data_1$Sample_2)
mean(data_1$Sample_3)
mean(data_1$Sample_4)
```
```{r}
# SD
sd(data_1$Sample_1)
sd(data_1$Sample_2)
sd(data_1$Sample_3)
sd(data_1$Sample_4)
```
```{r}
# CV
sd(data_1$Sample_1)/mean(data_1$Sample_1)
sd(data_1$Sample_2)/mean(data_1$Sample_2)
sd(data_1$Sample_3)/mean(data_1$Sample_3)
sd(data_1$Sample_4)/mean(data_1$Sample_4)
```
```{r}
# SE
sd(data_1$Sample_1)/sqrt(10)
sd(data_1$Sample_2)/sqrt(10)
sd(data_1$Sample_3)/sqrt(10)
sd(data_1$Sample_4)/sqrt(10)

```

> [1 point per list of statistics]. Again, full credit for CV or SE if the calculation is right but the Means / SDs calculated wrong. Take off max of 1 for typos in data entry.

## Calculate and compare:
[4 points]

- the mean of the four sample means. Compare this value to the overall mean (17.775). 
Note: to calculate the mean using the function `mean`, enclose the values in a vector: `mean(c(1,3,4,2))`
```{r}
mean(c(mean(data_1$Sample_1),mean(data_1$Sample_2),mean(data_1$Sample_3),mean(data_1$Sample_4)))
```
- the standard deviation of the four sample means. Compare this value to the average of the four standard deviations from above.
```{r}
sd(c(mean(data_1$Sample_1),mean(data_1$Sample_2),mean(data_1$Sample_3),mean(data_1$Sample_4)))
mean(c(sd(data_1$Sample_1),sd(data_1$Sample_2),sd(data_1$Sample_3),sd(data_1$Sample_4)))
```

- the theoretical standard error (standard deviation of sample means with sample size=10). Compare this to the standard deviation of the four sample means
```{r}
5/sqrt(10)
```
    
Explain why the standard deviation of the four means and the theoretical standard error of the mean (n=10) are smaller than the average of the four standard deviations.


> The mean of the four samples is the same as the overall mean. This is only true because the sample sizes were the same.

> The standard deviation of the 4 means is close to the theoretical standard error, and much less than the mean of the 4 standard deviations. This is because 
averaging the 4 standard deviations gives an estimate of the total variation in the population (normally to get a pooled estimate, you'd average variances, not standard deviations!), while the standard deviation of sample means estimates the variation in sample means. Sample means have much lower variance than individual observations.

> [2 points for the 5 statistics]
> [2 points for the explanations]. Explanations can be fine even if statistics are wrong.


## The following table was derived by subtracting Sample 1 from Sample 2 (S2-S1) and subtracting Sample 3 from Sample 4 (S4-S3). 
[4 points]

Calculate the mean and variance for each derived sample, and then find the average of these statistics.  
Compare these values with the theoretical values expected from the subtraction of two random variables, 
based on the true population parameters defined above.

```{r echo=FALSE}
data_2 <- data.frame(
              S2_minus_S1 = data_1$Sample_2 - data_1$Sample_1,
              S4_minus_S3 = data_1$Sample_4 - data_1$Sample_3
            )
data_2
```


```{r}
# Mean of means
mean(data_2$S2_minus_S1)
mean(data_2$S4_minus_S3)
mean(c(mean(data_2$S2_minus_S1),mean(data_2$S4_minus_S3)))
```
```{r}
# mean of variances
var(data_2$S2_minus_S1)
var(data_2$S4_minus_S3)
mean(c(var(data_2$S2_minus_S1),var(data_2$S4_minus_S3)))
```

> Since all four samples came from the same population, $\mu_2 - \mu_1 = 0$ and $\mu_4 - \mu_3 = 0$. 
Therefore, we'd expect both derived samples to have sample means close to zero.

> But, since each of the four samples are independent, the variance of the derived sample should equal the sum of the variances of the two samples. 
Variances add, even when you are subtracting. Since the population SD=5, the variance = 25, so we'd expect the variance of the difference to be 50.
The actual variances are a bit bigger than this, but not too far off.


> [2 points for the 5 statistics]
> [2 points for the explanations]. Explanations can be fine even if statistics are wrong.


---

# Part 2 

[Hint: With questions like these, it is very helpful to draw a figure first]

## Assume Y has a Normal distribution with mean=20 and variance = 10. Calculate the following:
[5 points]

Note: R's normal distribution functions use SD, not variance!

- Of 100 individuals sampled from this population, approximately how many would you expect to be smaller than 25?
```{r}
100*pnorm(25,mean=20,sd=sqrt(10))
```

- Of 100 individuals sampled from this population, approximately how many should be within 1.5 times the population's standard deviation? 
```{r}
# note: we find the percent less than mean + 1.5sd, and then subtract the percent smaller than mean - 1.5sd
100*(pnorm(20 + 1.5*sqrt(10), mean = 20, sd = sqrt(10)) - pnorm(20 - 1.5*sqrt(10), mean = 20, sd = sqrt(10)))
# note2: since we're working in units of SD, we can ignore the values of mean and SD! pnorm(1.5) - pnorm(-1.5)
```

- Find the expected 75th quantile of the distribution of Y (the value greater than 75% of the population)
```{r}
qnorm(0.75,mean=20,sd=sqrt(10))
```

- With a sample size of 15 from this population, what is the probability that the sample mean will be less than 19?
```{r}
SE = sqrt(10/15)
pnorm(19,mean = 20,sd = SE)
```

- With a sample size of 15, what is the probability that the sample mean will be within 1.5 times the population's standard deviation? 
```{r}
# like above, except we use the sd(mean), rather than sd(population)
100*(pnorm(20 + 1.5*sqrt(10),mean = 20, sd = SE) - pnorm(20 - 1.5*sqrt(10),mean = 20, sd = SE))
```
> [1 point for each of the 5 statistics]

---

# Part 3
[10 points]

Describe an experiment that you are currently running, one that you have run in the past, or will run soon, 
or make up an experiment that is relevant to your research. Use the terms we discussed in the first class. 
Cover the following items. A couple sentences or a brief list is fine. The goal of this is to get you thinking
about the issues in experimental design, and to help me understand the range of questions students are studying.
    
## Research question: 
What is the overal goal of the experiment?

> ENTER YOUR RESPONSE HERE

## Treatment structure: 
What treatments are you imposing? How are you imposing them? Are they qualitative or quantitative?
Are you using controls?

> ENTER YOUR RESPONSE HERE

## Design structure: 
What are your experimental units? What is the reference population (the broader set of all eu's you want to generalize about)?
How do you assign treatments to eu's? How many eu's per treatment?
How do you randomize? What confounding factors are you concerned about? What sources of variation do you expect will affect your results?

> ENTER YOUR RESPONSE HERE

## Response structure: 
What traits / quantities will you measure? How many measurements will you take per eu? 
How will you measure? What precautions will you take to prevent biases?

> ENTER YOUR RESPONSE HERE

## Are you OK wih me using / adapting this as an example in class / labs / exams?

> ENTER YOUR RESPONSE HERE

---
